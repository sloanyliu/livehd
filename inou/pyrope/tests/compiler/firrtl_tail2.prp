%out.__ubits = 4
$en.__ubits  = 1
$inp.__ubits = 4

#x = 0 
if ($en) {
  #x = $inp
} else {
  foo = #x.__q_pin - 1
  bar = #x.__q_pin
  bar := foo
  #x = bar
}

%out := #x.__q_pin